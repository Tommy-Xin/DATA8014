[32m[12/05 19:45:53 TiTok]: [0mSaving config to titok_b_128_stage1_run1/config.yaml
[32m[12/05 19:45:53 TiTok]: [0mConfig:
experiment:
  project: titok_b_128_stage1
  name: titok_b_128_stage1_run1
  output_dir: titok_b_128_stage1_run1
  max_train_examples: 1281167
  save_every: 50000
  eval_every: 50000
  generate_every: 5000
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  init_weight: ''
  logging_dir: titok_b_128_stage1_run1/logs
model:
  vq_model:
    codebook_size: 4096
    token_size: 12
    use_l2_norm: true
    commitment_cost: 0.25
    vit_enc_model_size: base
    vit_dec_model_size: base
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 128
    finetune_decoder: false
    pretrained_tokenizer_weight: maskgit-vqgan-imagenet-f16-256.bin
losses:
  quantizer_weight: 1.0
dataset:
  params:
    train_shards_path_or_url: imagenet_sharded/train/imagenet-train-{0000..0252}.tar
    eval_shards_path_or_url: imagenet_sharded/val/imagenet-val-{0000..0009}.tar
    num_workers_per_gpu: 12
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.99
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 32
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 1000000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/stage1/titok_b128.yaml

[32m[12/06 01:40:42 TiTok]: [0mSaving config to titok_b_128_stage1_run1/config.yaml
[32m[12/06 01:40:42 TiTok]: [0mConfig:
experiment:
  project: titok_b_128_stage1
  name: titok_b_128_stage1_run1
  output_dir: titok_b_128_stage1_run1
  max_train_examples: 1281167
  save_every: 50000
  eval_every: 50000
  generate_every: 5000
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  init_weight: ''
  logging_dir: titok_b_128_stage1_run1/logs
model:
  vq_model:
    codebook_size: 4096
    token_size: 12
    use_l2_norm: true
    commitment_cost: 0.25
    vit_enc_model_size: base
    vit_dec_model_size: base
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 128
    finetune_decoder: false
    pretrained_tokenizer_weight: maskgit-vqgan-imagenet-f16-256.bin
losses:
  quantizer_weight: 1.0
dataset:
  params:
    train_shards_path_or_url: imagenet_sharded/train/imagenet-train-{0000..0252}.tar
    eval_shards_path_or_url: imagenet_sharded/val/imagenet-val-{0000..0009}.tar
    num_workers_per_gpu: 12
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.99
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 32
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 1000000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/stage1/titok_b128.yaml

[32m[12/06 01:41:07 TiTok]: [0mCreating model and loss module.
[32m[12/06 01:41:10 TiTok]: [0m===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         98,304                      0.06%                   --                        --
â”œâ”€TiTokEncoder: 1-1                           --                        [1, 12, 1, 128]           296,448                     0.17%                   --                        --
â”‚    â””â”€Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
â”‚    â””â”€LayerNorm: 2-2                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-3                        --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â””â”€LayerNorm: 2-4                         [1, 128, 768]             [1, 128, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-5                            [1, 768, 128, 1]          [1, 12, 128, 1]           9,228                       0.01%                   [1, 1]                    1,181,184
â”œâ”€VectorQuantizer: 1-2                        [1, 12, 1, 128]           [1, 12, 1, 128]           --                             --                   --                        --
â”‚    â””â”€Embedding: 2-6                         [128]                     [128, 12]                 49,152                      0.03%                   --                        6,291,456
â”œâ”€TiTokDecoder: 1-3                           [1, 12, 1, 128]           [1, 1024, 16, 16]         297,216                     0.17%                   --                        --
â”‚    â””â”€Linear: 2-7                            [1, 128, 12]              [1, 128, 768]             9,984                       0.01%                   --                        9,984
â”‚    â””â”€LayerNorm: 2-8                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-9                        --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â””â”€LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
â”‚    â”‚    â””â”€Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
â”‚    â””â”€Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,221,068
Trainable params: 174,221,068
Non-trainable params: 0
Total mult-adds (G): 44.53
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 412.11
Params size (MB): 467.33
Estimated Total Size (MB): 880.23
===================================================================================================================================================================================================
[32m[12/06 01:41:10 TiTok]: [0mCreating optimizers.
[32m[12/06 01:41:10 TiTok]: [0mCreating lr_schedulers.
[32m[12/06 01:41:10 TiTok]: [0mCreating dataloaders.
[32m[12/06 01:41:10 TiTok]: [0mCreating evaluator.
[32m[12/06 01:41:10 TiTok]: [0mPreparing model, optimizer and dataloaders
[32m[12/06 01:41:11 TiTok]: [0m***** Running training *****
[32m[12/06 01:41:11 TiTok]: [0m  Num training steps = 1000000
[32m[12/06 01:41:11 TiTok]: [0m  Gradient Accumulation steps = 1
[32m[12/06 01:41:11 TiTok]: [0m  Instantaneous batch size per gpu = 32
[32m[12/06 01:41:11 TiTok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[12/06 01:41:11 TiTok]: [0mAll globbed checkpoints are: []
[32m[12/06 01:41:11 TiTok]: [0mTraining from scratch.
[32m[12/08 17:07:30 TiTok]: [0mSaving config to titok_b_128_stage1_run1/config.yaml
[32m[12/08 17:07:30 TiTok]: [0mConfig:
experiment:
  project: titok_b_128_stage1
  name: titok_b_128_stage1_run1
  output_dir: titok_b_128_stage1_run1
  max_train_examples: 1281167
  save_every: 50000
  eval_every: 50000
  generate_every: 5000
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  init_weight: ''
  logging_dir: titok_b_128_stage1_run1/logs
model:
  vq_model:
    codebook_size: 4096
    token_size: 12
    use_l2_norm: true
    commitment_cost: 0.25
    vit_enc_model_size: base
    vit_dec_model_size: base
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 128
    finetune_decoder: false
    pretrained_tokenizer_weight: maskgit-vqgan-imagenet-f16-256.bin
losses:
  quantizer_weight: 1.0
dataset:
  params:
    train_shards_path_or_url: imagenet_sharded/train/imagenet-train-{0000..0252}.tar
    eval_shards_path_or_url: imagenet_sharded/val/imagenet-val-{0000..0009}.tar
    num_workers_per_gpu: 12
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.99
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 32
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 1000000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/stage1/titok_b128.yaml

[32m[12/08 17:07:32 TiTok]: [0mCreating model and loss module.
[32m[12/08 17:07:35 TiTok]: [0m===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         98,304                      0.06%                   --                        --
â”œâ”€TiTokEncoder: 1-1                           --                        [1, 12, 1, 128]           296,448                     0.17%                   --                        --
â”‚    â””â”€Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
â”‚    â””â”€LayerNorm: 2-2                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-3                        --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6      [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8              [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9               [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7             [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8               [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9             [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9       [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â””â”€LayerNorm: 2-4                         [1, 128, 768]             [1, 128, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-5                            [1, 768, 128, 1]          [1, 12, 128, 1]           9,228                       0.01%                   [1, 1]                    1,181,184
â”œâ”€VectorQuantizer: 1-2                        [1, 12, 1, 128]           [1, 12, 1, 128]           --                             --                   --                        --
â”‚    â””â”€Embedding: 2-6                         [128]                     [128, 12]                 49,152                      0.03%                   --                        6,291,456
â”œâ”€TiTokDecoder: 1-3                           [1, 12, 1, 128]           [1, 1024, 16, 16]         297,216                     0.17%                   --                        --
â”‚    â””â”€Linear: 2-7                            [1, 128, 12]              [1, 128, 768]             9,984                       0.01%                   --                        9,984
â”‚    â””â”€LayerNorm: 2-8                         [1, 385, 768]             [1, 385, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-9                        --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24      [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94     [385, 1, 768]             [385, 1, 768]             2,362,368                   1.36%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95              [385, 1, 768]             [385, 1, 768]             1,536                       0.00%                   --                        591,360
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96             [385, 1, 768]             [385, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70            [385, 1, 768]             [385, 1, 3072]            2,362,368                   1.36%                   --                        909,511,680
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71              [385, 1, 3072]            [385, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72            [385, 1, 3072]            [385, 1, 768]             2,360,064                   1.35%                   --                        908,624,640
â”‚    â””â”€LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
â”‚    â”‚    â””â”€Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
â”‚    â””â”€Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,221,068
Trainable params: 174,221,068
Non-trainable params: 0
Total mult-adds (G): 44.53
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 412.11
Params size (MB): 467.33
Estimated Total Size (MB): 880.23
===================================================================================================================================================================================================
[32m[12/08 17:07:35 TiTok]: [0mCreating optimizers.
[32m[12/08 17:07:35 TiTok]: [0mCreating lr_schedulers.
[32m[12/08 17:07:35 TiTok]: [0mCreating dataloaders.
[32m[12/08 17:07:35 TiTok]: [0mCreating evaluator.
[32m[12/08 17:07:35 TiTok]: [0mPreparing model, optimizer and dataloaders
[32m[12/08 17:07:35 TiTok]: [0m***** Running training *****
[32m[12/08 17:07:35 TiTok]: [0m  Num training steps = 1000000
[32m[12/08 17:07:35 TiTok]: [0m  Gradient Accumulation steps = 1
[32m[12/08 17:07:35 TiTok]: [0m  Instantaneous batch size per gpu = 32
[32m[12/08 17:07:35 TiTok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[12/08 17:07:35 TiTok]: [0mAll globbed checkpoints are: []
[32m[12/08 17:07:35 TiTok]: [0mTraining from scratch.
